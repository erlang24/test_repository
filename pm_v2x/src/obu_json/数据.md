[INFO] [1724219827.286992410] [obu_handle_node]: 收到消息: {"MessageFrame": {"mapFrame": {"msgCnt": "0", "timeStamp": "18", "nodes": {"Node": {"name": "node_5", "id": {"region": "500", "id": "5"}, "refPos": {"lat": "35999816", "long": "116999576"}, "inLinks": {"Link": [{"name": "west", "upstreamNodeId": {"id": "1", "region": "500"}, "speedLimits": {"RegulatorySpeedLimit": {"type": {"vehicleMaxSpeed": null}, "speed": "833"}}, "linkWidth": "600", "movements": {"Movement": [{"remoteIntersection": {"region": "500", "id": "2"}, "phaseId": "6"}, {"remoteIntersection": {"region": "500", "id": "4"}, "phaseId": "7"}, {"remoteIntersection": {"region": "500", "id": "3"}, "phaseId": "9"}]}, "points": {"RoadPoint": [{"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999158", "lat": "35999747"}}}}, {"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999194", "lat": "35999747"}}}}, {"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999297", "lat": "35999747"}}}}, {"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999359", "lat": "35999747"}}}}, {"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999424", "lat": "35999747"}}}}]}, "lanes": {"Lane": [{"laneId": "1", "laneWidth": "300", "maneuvers": "110000000000", "connectsTo": {"Connection": [{"remoteIntersection": {"region": "500", "id": "2"}, "connectingLane": {"lane": "1", "maneuver": "100000000000"}, "phaseId": "6"}, {"remoteIntersection": {"region": "500", "id": "4"}, "connectingLane": {"lane": "1", "maneuver": "010000000000"}, "phaseId": "7"}]}, "speedLimits": {"RegulatorySpeedLimit": {"type": {"vehicleMaxSpeed": null}, "speed": "833"}}, "points": {"RoadPoint": [{"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999175", "lat": "35999780"}}}}, {"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999232", "lat": "35999779"}}}}, {"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999348", "lat": "35999778"}}}}, {"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999408", "lat": "35999778"}}}}, {"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999422", "lat": "35999778"}}}}]}}, {"laneId": "2", "laneWidth": "300", "maneuvers": "101000000000", "connectsTo": {"Connection": [{"remoteIntersection": {"region": "500", "id": "2"}, "connectingLane": {"lane": "1", "maneuver": "100000000000"}, "phaseId": "6"}, {"remoteIntersection": {"region": "500", "id": "3"}, "connectingLane": {"lane": "1", "maneuver": "001000000000"}, "phaseId": "9"}]}, "speedLimits": {"RegulatorySpeedLimit": {"type": {"vehicleMaxSpeed": null}, "speed": "833"}}, "points": {"RoadPoint": [{"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999158", "lat": "35999747"}}}}, {"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999194", "lat": "35999747"}}}}, {"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999297", "lat": "35999747"}}}}, {"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999359", "lat": "35999747"}}}}, {"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999424", "lat": "35999747"}}}}]}}]}}, {"name": "north", "upstreamNodeId": {"id": "4", "region": "500"}, "speedLimits": {"RegulatorySpeedLimit": {"type": {"vehicleMaxSpeed": null}, "speed": "833"}}, "linkWidth": "600", "movements": {"Movement": [{"remoteIntersection": {"region": "500", "id": "3"}, "phaseId": "16"}, {"remoteIntersection": {"region": "500", "id": "2"}, "phaseId": "17"}, {"remoteIntersection": {"region": "500", "id": "1"}, "phaseId": "19"}]}, "points": {"RoadPoint": [{"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999158", "lat": "35999747"}}}}, {"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999194", "lat": "35999747"}}}}, {"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999297", "lat": "35999747"}}}}, {"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999359", "lat": "35999747"}}}}, {"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999424", "lat": "35999747"}}}}]}, "lanes": {"Lane": [{"laneId": "1", "laneWidth": "300", "maneuvers": "110000000000", "connectsTo": {"Connection": [{"remoteIntersection": {"region": "500", "id": "3"}, "connectingLane": {"lane": "1", "maneuver": "100000000000"}, "phaseId": "16"}, {"remoteIntersection": {"region": "500", "id": "2"}, "connectingLane": {"lane": "1", "maneuver": "010000000000"}, "phaseId": "17"}]}, "speedLimits": {"RegulatorySpeedLimit": {"type": {"vehicleMaxSpeed": null}, "speed": "833"}}, "points": {"RoadPoint": [{"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999562", "lat": "36000401"}}}}, {"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999562", "lat": "36000319"}}}}, {"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999561", "lat": "36000242"}}}}, {"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999560", "lat": "36000142"}}}}, {"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999560", "lat": "36000017"}}}}]}}, {"laneId": "2", "laneWidth": "300", "maneuvers": "101000000000", "connectsTo": {"Connection": [{"remoteIntersection": {"region": "500", "id": "3"}, "connectingLane": {"lane": "1", "maneuver": "100000000000"}, "phaseId": "16"}, {"remoteIntersection": {"region": "500", "id": "1"}, "connectingLane": {"lane": "1", "maneuver": "001000000000"}, "phaseId": "19"}]}, "speedLimits": {"RegulatorySpeedLimit": {"type": {"vehicleMaxSpeed": null}, "speed": "833"}}, "points": {"RoadPoint": [{"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999532", "lat": "36000390"}}}}, {"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999531", "lat": "36000261"}}}}, {"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999530", "lat": "36000196"}}}}, {"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999530", "lat": "36000113"}}}}, {"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999529", "lat": "36000022"}}}}]}}]}}]}}}}}}
[INFO] [1724219827.288165400] [obu_handle_node]: 接收到的数据哈希值: 4b9369f166dc77a9f1cef61df58d8664
[INFO] [1724219827.288777886] [obu_handle_node]: 十字路口名称: node_5, 参考位置: (纬度: 35.999816, 经度: 116.999576)
[INFO] [1724219827.289330425] [obu_handle_node]: 链接名称: west, 速度限制: 60 km/h
[INFO] [1724219827.289868887] [obu_handle_node]:   车道ID: 1, 宽度: 300, 操作: 110000000000
[INFO] [1724219827.290341250] [obu_handle_node]:     连接到下游路段: 2 (区域: 500), 当前相位ID: 6, 连接车道: 1, 操作: 100000000000
[INFO] [1724219827.290790005] [obu_handle_node]:     连接到下游路段: 4 (区域: 500), 当前相位ID: 7, 连接车道: 1, 操作: 010000000000
[INFO] [1724219827.291295758] [obu_handle_node]:     车道ID: 1, 第1个点位置: (纬度: 35.99978, 经度: 116.999175), 距离: 61.06 米
[INFO] [1724219827.291779905] [obu_handle_node]:     车道ID: 1, 第2个点位置: (纬度: 35.999779, 经度: 116.999232), 距离: 58.64 米
[INFO] [1724219827.292251981] [obu_handle_node]:     车道ID: 1, 第3个点位置: (纬度: 35.999778, 经度: 116.999348), 距离: 54.77 米
[INFO] [1724219827.292745349] [obu_handle_node]:     车道ID: 1, 第4个点位置: (纬度: 35.999778, 经度: 116.999408), 距离: 53.40 米
[INFO] [1724219827.293222197] [obu_handle_node]:     车道ID: 1, 第5个点位置: (纬度: 35.999778, 经度: 116.999422), 距离: 53.16 米
[INFO] [1724219827.293675901] [obu_handle_node]:   车道ID: 2, 宽度: 300, 操作: 101000000000
[INFO] [1724219827.294124965] [obu_handle_node]:     连接到下游路段: 2 (区域: 500), 当前相位ID: 6, 连接车道: 1, 操作: 100000000000
[INFO] [1724219827.294579932] [obu_handle_node]:     连接到下游路段: 3 (区域: 500), 当前相位ID: 9, 连接车道: 1, 操作: 001000000000
[INFO] [1724219827.295065177] [obu_handle_node]:     车道ID: 2, 第1个点位置: (纬度: 35.999747, 经度: 116.999158), 距离: 64.99 米
[INFO] [1724219827.295547293] [obu_handle_node]:     车道ID: 2, 第2个点位置: (纬度: 35.999747, 经度: 116.999194), 距离: 63.38 米
[INFO] [1724219827.296026691] [obu_handle_node]:     车道ID: 2, 第3个点位置: (纬度: 35.999747, 经度: 116.999297), 距离: 59.52 米
[INFO] [1724219827.296506032] [obu_handle_node]:     车道ID: 2, 第4个点位置: (纬度: 35.999747, 经度: 116.999359), 距离: 57.79 米
[INFO] [1724219827.296985177] [obu_handle_node]:     车道ID: 2, 第5个点位置: (纬度: 35.999747, 经度: 116.999424), 距离: 56.52 米
[INFO] [1724219827.297410774] [obu_handle_node]: 链接名称: north, 速度限制: 60 km/h
[INFO] [1724219827.297831748] [obu_handle_node]:   车道ID: 1, 宽度: 300, 操作: 110000000000
[INFO] [1724219827.298252872] [obu_handle_node]:     连接到下游路段: 3 (区域: 500), 当前相位ID: 16, 连接车道: 1, 操作: 100000000000
[INFO] [1724219827.298672124] [obu_handle_node]:     连接到下游路段: 2 (区域: 500), 当前相位ID: 17, 连接车道: 1, 操作: 010000000000
[INFO] [1724219827.299087959] [obu_handle_node]:     车道ID: 1, 第1个点位置: (纬度: 36.000401, 经度: 116.999562), 距离: 17.25 米
[INFO] [1724219827.299486828] [obu_handle_node]:     车道ID: 1, 第2个点位置: (纬度: 36.000319, 经度: 116.999562), 距离: 8.40 米
[INFO] [1724219827.299872944] [obu_handle_node]:     车道ID: 1, 第3个点位置: (纬度: 36.000242, 经度: 116.999561), 距离: 2.87 米
[INFO] [1724219827.300229627] [obu_handle_node]:     车道ID: 1, 第4个点位置: (纬度: 36.000142, 经度: 116.99956), 距离: 12.09 米
[INFO] [1724219827.300600353] [obu_handle_node]:     车道ID: 1, 第5个点位置: (纬度: 36.000017, 经度: 116.99956), 距离: 25.83 米
[INFO] [1724219827.300940989] [obu_handle_node]: OBU车辆在车道 north (车道ID: 1) 上，最近点位置: (纬度: 36.000242, 经度: 116.999561), 距离: 2.87 米
[INFO] [1724219827.301259684] [obu_handle_node]:   车道ID: 2, 宽度: 300, 操作: 101000000000
[INFO] [1724219827.301553118] [obu_handle_node]:     连接到下游路段: 3 (区域: 500), 当前相位ID: 16, 连接车道: 1, 操作: 100000000000
[INFO] [1724219827.301850686] [obu_handle_node]:     连接到下游路段: 1 (区域: 500), 当前相位ID: 19, 连接车道: 1, 操作: 001000000000
[INFO] [1724219827.302152639] [obu_handle_node]:     车道ID: 2, 第1个点位置: (纬度: 36.00039, 经度: 116.999532), 距离: 15.79 米
[INFO] [1724219827.302436797] [obu_handle_node]:     车道ID: 2, 第2个点位置: (纬度: 36.000261, 经度: 116.999531), 距离: 1.45 米
[INFO] [1724219827.302709790] [obu_handle_node]:     车道ID: 2, 第3个点位置: (纬度: 36.000196, 经度: 116.99953), 距离: 5.78 米
[INFO] [1724219827.302979728] [obu_handle_node]:     车道ID: 2, 第4个点位置: (纬度: 36.000113, 经度: 116.99953), 距离: 15.01 米
[INFO] [1724219827.303236523] [obu_handle_node]:     车道ID: 2, 第5个点位置: (纬度: 36.000022, 经度: 116.999529), 距离: 25.13 米
[INFO] [1724219827.303474961] [obu_handle_node]: OBU车辆在车道 north (车道ID: 2) 上，最近点位置: (纬度: 36.000261, 经度: 116.999531), 距离: 1.45 米
[INFO] [1724219827.405214243] [obu_handle_node]: OBU车辆GPS位置: 纬度: 36.000248, 经度: 116.99953


### ######################################################################################################################

收到透传过来的消息: {"MessageFrame": {"mapFrame": {"msgCnt": "0", "timeStamp": "18", "nodes": {"Node": {"name": "node_5", "id": {"region": "500", "id": "5"}, "refPos": {"lat": "35999816", "long": "116999576"}, "inLinks": {"Link": [{"name": "west", "upstreamNodeId": {"id": "1", "region": "500"}, "speedLimits": {"RegulatorySpeedLimit": {"type": {"vehicleMaxSpeed": null}, "speed": "833"}}, "linkWidth": "600", "movements": {"Movement": [{"remoteIntersection": {"region": "500", "id": "2"}, "phaseId": "6"}, {"remoteIntersection": {"region": "500", "id": "4"}, "phaseId": "7"}, {"remoteIntersection": {"region": "500", "id": "3"}, "phaseId": "9"}]}, "points": {"RoadPoint": [{"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999158", "lat": "35999747"}}}}, {"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999194", "lat": "35999747"}}}}, {"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999297", "lat": "35999747"}}}}, {"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999359", "lat": "35999747"}}}}, {"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999424", "lat": "35999747"}}}}]}, "lanes": {"Lane": [{"laneId": "1", "laneWidth": "300", "maneuvers": "110000000000", "connectsTo": {"Connection": [{"remoteIntersection": {"region": "500", "id": "2"}, "connectingLane": {"lane": "1", "maneuver": "100000000000"}, "phaseId": "6"}, {"remoteIntersection": {"region": "500", "id": "4"}, "connectingLane": {"lane": "1", "maneuver": "010000000000"}, "phaseId": "7"}]}, "speedLimits": {"RegulatorySpeedLimit": {"type": {"vehicleMaxSpeed": null}, "speed": "833"}}, "points": {"RoadPoint": [{"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999175", "lat": "35999780"}}}}, {"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999232", "lat": "35999779"}}}}, {"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999348", "lat": "35999778"}}}}, {"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999408", "lat": "35999778"}}}}, {"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999422", "lat": "35999778"}}}}]}}, {"laneId": "2", "laneWidth": "300", "maneuvers": "101000000000", "connectsTo": {"Connection": [{"remoteIntersection": {"region": "500", "id": "2"}, "connectingLane": {"lane": "1", "maneuver": "100000000000"}, "phaseId": "6"}, {"remoteIntersection": {"region": "500", "id": "3"}, "connectingLane": {"lane": "1", "maneuver": "001000000000"}, "phaseId": "9"}]}, "speedLimits": {"RegulatorySpeedLimit": {"type": {"vehicleMaxSpeed": null}, "speed": "833"}}, "points": {"RoadPoint": [{"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999158", "lat": "35999747"}}}}, {"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999194", "lat": "35999747"}}}}, {"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999297", "lat": "35999747"}}}}, {"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999359", "lat": "35999747"}}}}, {"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999424", "lat": "35999747"}}}}]}}]}}, {"name": "south", "upstreamNodeId": {"id": "3", "region": "500"}, "speedLimits": {"RegulatorySpeedLimit": {"type": {"vehicleMaxSpeed": null}, "speed": "833"}}, "linkWidth": "600", "movements": {"Movement": [{"remoteIntersection": {"region": "500", "id": "4"}, "phaseId": "36"}, {"remoteIntersection": {"region": "500", "id": "1"}, "phaseId": "37"}, {"remoteIntersection": {"region": "500", "id": "2"}, "phaseId": "39"}]}, "points": {"RoadPoint": [{"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999158", "lat": "35999747"}}}}, {"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999194", "lat": "35999747"}}}}, {"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999297", "lat": "35999747"}}}}, {"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999359", "lat": "35999747"}}}}, {"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999424", "lat": "35999747"}}}}]}, "lanes": {"Lane": [{"laneId": "1", "laneWidth": "300", "maneuvers": "110000000000", "connectsTo": {"Connection": [{"remoteIntersection": {"region": "500", "id": "4"}, "connectingLane": {"lane": "1", "maneuver": "100000000000"}, "phaseId": "36"}, {"remoteIntersection": {"region": "500", "id": "1"}, "connectingLane": {"lane": "1", "maneuver": "010000000000"}, "phaseId": "37"}]}, "speedLimits": {"RegulatorySpeedLimit": {"type": {"vehicleMaxSpeed": null}, "speed": "833"}}, "points": {"RoadPoint": [{"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999596", "lat": "35999005"}}}}, {"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999597", "lat": "35999218"}}}}, {"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999595", "lat": "35999424"}}}}, {"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999596", "lat": "35999514"}}}}, {"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999594", "lat": "35999624"}}}}]}}, {"laneId": "2", "laneWidth": "300", "maneuvers": "101000000000", "connectsTo": {"Connection": [{"remoteIntersection": {"region": "500", "id": "4"}, "connectingLane": {"lane": "1", "maneuver": "100000000000"}, "phaseId": "36"}, {"remoteIntersection": {"region": "500", "id": "2"}, "connectingLane": {"lane": "1", "maneuver": "001000000000"}, "phaseId": "39"}]}, "speedLimits": {"RegulatorySpeedLimit": {"type": {"vehicleMaxSpeed": null}, "speed": "833"}}, "points": {"RoadPoint": [{"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999628", "lat": "35998998"}}}}, {"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999627", "lat": "35999143"}}}}, {"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999628", "lat": "35999317"}}}}, {"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999626", "lat": "35999498"}}}}, {"posOffset": {"offsetLL": {"position-LatLon": {"lon": "116999626", "lat": "35999624"}}}}]}}]}}]}}}}}}
[INFO] [1725329196.142448823] [obu_handle_node]: 接收到的数据哈希值: 681b17d2986cb1832e2b85a1915f4fa9
[INFO] [1725329196.142650158] [obu_handle_node]: 十字路口名称: node_5, 参考位置: (纬度: 36.666360000000005, 经度: 117.66596)
[INFO] [1725329196.142828338] [obu_handle_node]: 链接名称: west, 速度限制: 60 km/h
[INFO] [1725329196.143020981] [obu_handle_node]:   车道ID: 1, 宽度: 300, 操作: 110000000000
[INFO] [1725329196.143221515] [obu_handle_node]:     车道ID: 1, 第1个点位置: (纬度: 36.6663, 经度: 117.66529166666666), 距离: 95145.70 米
[INFO] [1725329196.143414718] [obu_handle_node]:     车道ID: 1, 第2个点位置: (纬度: 36.66629833333333, 经度: 117.66538666666665), 距离: 95150.89 米
[INFO] [1725329196.143600113] [obu_handle_node]:     车道ID: 1, 第3个点位置: (纬度: 36.66629666666667, 经度: 117.66558000000002), 距离: 95161.61 米
[INFO] [1725329196.143794444] [obu_handle_node]:     车道ID: 1, 第4个点位置: (纬度: 36.66629666666667, 经度: 117.66568000000001), 距离: 95167.22 米
[INFO] [1725329196.143979009] [obu_handle_node]:     车道ID: 1, 第5个点位置: (纬度: 36.66629666666667, 经度: 117.66570333333333), 距离: 95168.53 米
[INFO] [1725329196.144136883] [obu_handle_node]:     连接到下游路段: 2 (区域: 500), 当前相位ID: 6, 连接车道: 1, 操作: 100000000000
[INFO] [1725329196.144329327] [obu_handle_node]:     连接到下游路段: 4 (区域: 500), 当前相位ID: 7, 连接车道: 1, 操作: 010000000000
[INFO] [1725329196.144512253] [obu_handle_node]:   车道ID: 2, 宽度: 300, 操作: 101000000000
[INFO] [1725329196.144706040] [obu_handle_node]:     车道ID: 2, 第1个点位置: (纬度: 36.666245, 经度: 117.66526333333334), 距离: 95139.36 米
[INFO] [1725329196.144891087] [obu_handle_node]:     车道ID: 2, 第2个点位置: (纬度: 36.666245, 经度: 117.66532333333335), 距离: 95142.73 米
[INFO] [1725329196.145056734] [obu_handle_node]:     车道ID: 2, 第3个点位置: (纬度: 36.666245, 经度: 117.665495), 距离: 95152.37 米
[INFO] [1725329196.145220323] [obu_handle_node]:     车道ID: 2, 第4个点位置: (纬度: 36.666245, 经度: 117.66559833333334), 距离: 95158.17 米
[INFO] [1725329196.145401213] [obu_handle_node]:     车道ID: 2, 第5个点位置: (纬度: 36.666245, 经度: 117.66570666666667), 距离: 95164.26 米
[INFO] [1725329196.145579347] [obu_handle_node]:     连接到下游路段: 2 (区域: 500), 当前相位ID: 6, 连接车道: 1, 操作: 100000000000
[INFO] [1725329196.145755425] [obu_handle_node]:     连接到下游路段: 3 (区域: 500), 当前相位ID: 9, 连接车道: 1, 操作: 001000000000
[INFO] [1725329196.145930657] [obu_handle_node]: 链接名称: south, 速度限制: 60 km/h
[INFO] [1725329196.146088538] [obu_handle_node]:   车道ID: 1, 宽度: 300, 操作: 110000000000
[INFO] [1725329196.146270110] [obu_handle_node]:     车道ID: 1, 第1个点位置: (纬度: 36.66500833333334, 经度: 117.66599333333333), 距离: 95073.60 米
[INFO] [1725329196.146457003] [obu_handle_node]:     车道ID: 1, 第2个点位置: (纬度: 36.66536333333333, 经度: 117.665995), 距离: 95104.33 米
[INFO] [1725329196.146649340] [obu_handle_node]:     车道ID: 1, 第3个点位置: (纬度: 36.665706666666665, 经度: 117.66599166666668), 距离: 95133.78 米
[INFO] [1725329196.146834896] [obu_handle_node]:     车道ID: 1, 第4个点位置: (纬度: 36.66585666666666, 经度: 117.66599333333333), 距离: 95146.83 米
[INFO] [1725329196.147013419] [obu_handle_node]:     车道ID: 1, 第5个点位置: (纬度: 36.666039999999995, 经度: 117.66599), 距离: 95162.47 米
[INFO] [1725329196.147176852] [obu_handle_node]:     连接到下游路段: 4 (区域: 500), 当前相位ID: 36, 连接车道: 1, 操作: 100000000000
[INFO] [1725329196.147335627] [obu_handle_node]:     连接到下游路段: 1 (区域: 500), 当前相位ID: 37, 连接车道: 1, 操作: 010000000000
[INFO] [1725329196.147533585] [obu_handle_node]:   车道ID: 2, 宽度: 300, 操作: 101000000000
[INFO] [1725329196.147731110] [obu_handle_node]:     车道ID: 2, 第1个点位置: (纬度: 36.66499666666667, 经度: 117.66604666666666), 距离: 95075.59 米
[INFO] [1725329196.147918195] [obu_handle_node]:     车道ID: 2, 第2个点位置: (纬度: 36.665238333333335, 经度: 117.666045), 距离: 95096.36 米
[INFO] [1725329196.148098853] [obu_handle_node]:     车道ID: 2, 第3个点位置: (纬度: 36.665528333333334, 经度: 117.66604666666666), 距离: 95121.48 米
[INFO] [1725329196.148257427] [obu_handle_node]:     车道ID: 2, 第4个点位置: (纬度: 36.66583, 经度: 117.66604333333335), 距离: 95147.34 米
[INFO] [1725329196.148473579] [obu_handle_node]:     车道ID: 2, 第5个点位置: (纬度: 36.666039999999995, 经度: 117.66604333333335), 距离: 95165.47 米
[INFO] [1725329196.148652125] [obu_handle_node]:     连接到下游路段: 4 (区域: 500), 当前相位ID: 36, 连接车道: 1, 操作: 100000000000
[INFO] [1725329196.148825703] [obu_handle_node]:     连接到下游路段: 2 (区域: 500), 当前相位ID: 39, 连接车道: 1, 操作: 001000000000
[INFO] [1725329196.148997152] [obu_handle_node]: OBU车辆未找到匹配的车道






```python
class UDPMessageReceiver(Node):
    def __init__(self):
        super().__init__('obu_handle_node')
        self.subscription = self.create_subscription(String, '/receive_UDPstring_messages', self.listener_callback, 10)
        self.gps_subscription = self.create_subscription(NavSatFix, '/local_messages_b', self.gps_callback, 10)
        self.current_gps = None

        self.get_logger().info("节点已启动，等待消息连接...")

    def listener_callback(self, msg):
        message = msg.data
        self.get_logger().info(f"收到消息: {message}")

        try:
            json_data = json.loads(message)  # 尝试解析JSON数据

            # 计算接收到的消息的哈希值
            received_hash = hashlib.md5(message.encode('utf-8')).hexdigest()
            self.get_logger().info(f"接收到的数据哈希值: {received_hash}")

            # 解析ASN
            self.parse_asn_info(json_data)
        except json.JSONDecodeError as e:
            self.get_logger().error(f"收到的数据不是有效的JSON格式，忽略... 错误: {e}")

    def gps_callback(self, msg):
        self.current_gps = (msg.latitude, msg.longitude)
        latitude = msg.latitude
        longitude = msg.longitude
        heading = msg.altitude
        self.get_logger().info(f"OBU车辆GPS位置: 纬度: {latitude}, 经度: {longitude}, 航向角: {heading}")

    def parse_asn_info(self, json_data):
        """解析ASN编码的十字路口信息。"""
        try:
            nodes = json_data.get("MessageFrame", {}).get("mapFrame", {}).get("nodes", {}).get("Node", {})
            node_name = nodes.get("name")
            ref_pos = nodes.get("refPos", {})
            lat = ref_pos.get("lat")
            long = ref_pos.get("long")

            if lat and long:
                lat = self.convert_lat_long(lat)
                long = self.convert_lat_long(long, is_longitude=True)

            self.get_logger().info(f"十字路口名称: {node_name}, 参考位置: (纬度: {lat}, 经度: {long})")

            in_links = nodes.get("inLinks", {}).get("Link", [])
            closest_lane = None
            closest_lane_info = {}

            for link in in_links:
                link_name = link.get("name")
                lanes = link.get("lanes", {}).get("Lane", [])
                speed_limit = link.get("speedLimits", {}).get("RegulatorySpeedLimit", {}).get("speed")
                max_speed_kmh = round((int(speed_limit) * 0.02 * 3.6)) if speed_limit else None  # 转换为 km/h

                self.get_logger().info(f"链接名称: {link_name}, 速度限制: {max_speed_kmh} km/h")

                for lane in lanes:
                    lane_id = lane.get("laneId")
                    lane_width = lane.get("laneWidth")
                    maneuvers = lane.get("maneuvers")
                    self.get_logger().info(f"  车道ID: {lane_id}, 宽度: {lane_width}, 操作: {maneuvers}")

                    # 新增逻辑：用于先判断车辆在哪条车道上
                    closest_point = None
                    closest_distance = float('inf')
                    point_index = None

                    points = lane.get("points", {}).get("RoadPoint", [])
                    for idx, roadpoint in enumerate(points, start=1):
                        position = roadpoint.get("posOffset", {}).get("offsetLL", {}).get("position-LatLon", {})
                        lon = position.get("lon")
                        lat = position.get("lat")

                        if lon and lat:
                            lon = self.convert_lat_long(lon, is_longitude=True)
                            lat = self.convert_lat_long(lat)

                            # 计算距离
                            distance = self.calculate_distance(self.current_gps, (lat, lon))
                            if distance < closest_distance:
                                closest_distance = distance
                                closest_point = (lat, lon)
                                point_index = len(points) - idx + 1  # 计算点索引

                            # 原有逻辑：遍历每个车道的点并计算距离
                            self.get_logger().info(f"    车道ID: {lane_id}, 第{idx}个点位置: (纬度: {lat}, 经度: {lon}), 距离: {distance:.2f} 米")

                    # 如果最近点存在且距离小于10米，则认为在车道上
                    if closest_point and closest_distance < 10:
                        if not closest_lane or closest_distance < closest_lane_info.get('distance', float('inf')):
                            closest_lane = lane_id
                            closest_lane_info = {
                                'lane_id': lane_id,
                                'lane_name': link_name,
                                'point_index': point_index,
                                'distance': closest_distance,
                                'position': closest_point
                            }

                    # 原有逻辑：解析连接信息
                    connects_to = lane.get("connectsTo", {}).get("Connection", [])
                    for connection in connects_to:
                        remote_intersection = connection.get("remoteIntersection", {})
                        phase_id = connection.get("phaseId")
                        region_id = remote_intersection.get("region")
                        road_id = remote_intersection.get("id")
                        connecting_lane = connection.get("connectingLane", {}).get("lane")
                        connecting_maneuver = connection.get("connectingLane", {}).get("maneuver")

                        self.get_logger().info(f"    连接到下游路段: {road_id} (区域: {region_id}), 当前相位ID: {phase_id}, 连接车道: {connecting_lane}, 操作: {connecting_maneuver}")

            # 新增逻辑：如果找到了车道，则打印车辆在哪条车道的第几个点附近
            if closest_lane:
                self.get_logger().info(f"OBU车辆位于车道: {closest_lane_info['lane_name']} (车道ID: {closest_lane_info['lane_id']}), 在第{closest_lane_info['point_index']}个点附近, 距离: {closest_lane_info['distance']:.2f} 米")
            else:
                self.get_logger().info("OBU车辆未找到匹配的车道")

        except KeyError as e:
            self.get_logger().error(f"解析ASN信息时发生错误: {e}")

    def calculate_distance(self, gps1, gps2):
        """计算两点之间的距离（米）"""
        if gps1 and gps2:
            lat1, lon1 = gps1
            lat2, lon2 = gps2
            # 使用哈弗辛公式计算距离
            R = 6371000  # 地球半径（米）
            phi1 = math.radians(lat1)
            phi2 = math.radians(lat2)
            delta_phi = math.radians(lat2 - lat1)
            delta_lambda = math.radians(lon2 - lon1)
            a = math.sin(delta_phi / 2) ** 2 + math.cos(phi1) * math.cos(phi2) * math.sin(delta_lambda / 2) ** 2
            c = 2 * math.atan2(math.sqrt(a), math.sqrt(1 - a))
            return R * c  # 返回距离（米）
        return float('inf')

    def convert_lat_long(self, value, is_longitude=False):
        if is_longitude:
            return float(f"{value[:3]}.{value[3:]}")
        else:
            return float(f"{value[:2]}.{value[2:]}")

def main(args=None):
    rclpy.init(args=args)
    udp_message_receiver = UDPMessageReceiver()

    try:
        rclpy.spin(udp_message_receiver)
    except KeyboardInterrupt:
        pass
    finally:
        udp_message_receiver.destroy_node()
        rclpy.shutdown()

if __name__ == "__main__":
    main()
```